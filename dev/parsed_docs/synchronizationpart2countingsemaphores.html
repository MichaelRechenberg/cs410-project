A counting semaphore contains a value and supports two operations "wait" and "post". Post increments the semaphore and immediately returns. "wait" will wait if the count is zero. If the count is non-zero the semaphore decrements the count and immediately returns.
An analogy is a count of the cookies in a cookie jar (or gold coins in the treasure chest). Before taking a cookie, call 'wait'. If there are no cookies left then wait will not return: It will wait until another thread increments the semaphore by calling post.
In short, post increments and immediately returns whereas wait will wait if the count is zero. Before returning it will decrement count.
This page introduces unnamed semaphores. Unfortunately Mac OS X does not support these yet.
First decide if the initial value should be zero or some other value (e.g. the number of remaining spaces in an array).
Unlike pthread mutex there are not shortcuts to creating a semaphore - use sem_init
Yes! Unlike a mutex, the increment and decrement can be from different threads.
Yes - though the overhead of a semaphore is greater. To use a semaphore:
 Initialize the semaphore with a count of one.
 Replace ...lock with sem_wait
* Replace ...unlock with sem_post
Yes! sem_post is one of a handful of functions that can be correctly used inside a signal handler.
This means we can release a waiting thread which can now make all of the calls that we were not
allowed to call inside the signal handler itself (e.g. printf).
Note robust programs do not use signal() in a multi-threaded program ("The effects of signal() in a multithreaded process are unspecified." - the signal man page); a more correct program will need to use sigaction.
Play using a real linux system! (9/19/14: Linux-In-the-Browser project is missing semaphore.h - this will be fixed in the next update). Read the man pages:
 sem_init
 sem_wait
 sem_post
 sem_destroy
What is a counting semaphore?
How do I create a semaphore?
Can I call wait and post from different threads?
Can I use a semaphore instead of a mutex?
Can I use sem_post inside a signal handler?
How do I find out more?
Synchronization, Part 2: Counting Semaphores
Synchronization, Part 2: Counting Semaphores
